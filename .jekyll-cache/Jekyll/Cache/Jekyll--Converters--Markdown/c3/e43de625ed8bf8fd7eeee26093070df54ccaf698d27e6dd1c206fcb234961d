I"ˆğ<p><br /></p>

<h2 id="ê³ ê¸‰ë§¤í•‘">ê³ ê¸‰ë§¤í•‘</h2>

<h3 id="1-ìƒì†ê´€ê³„-ë§¤í•‘">1. ìƒì†ê´€ê³„ ë§¤í•‘</h3>

<blockquote>
  <ul>
    <li>ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìƒì† ê´€ê³„ X (ê°ì²´ëŠ” ìƒì†ê´€ê³„ê°€ ìˆìŒ)</li>
    <li><strong>ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì…</strong> ê´€ê³„ë¼ëŠ” ëª¨ë¸ë§ ê¸°ë²•ì´ ê°ì²´ ìƒì†ê³¼ ìœ ì‚¬</li>
    <li><strong>ìƒì†ê´€ê³„ ë§¤í•‘</strong> : ê°ì²´ì˜ ìƒì† êµ¬ì¡°ì™€ DBì˜ ìŠˆí¼íƒ€ì…, ì„œë¸Œíƒ€ì… ê´€ê³„ë¥¼ ë§¤í•‘</li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>ìŠˆí¼íƒ€ì… ë…¼ë¦¬ ëª¨ë¸ì„ ì‹¤ì œ ë¬¼ë¦¬ ëª¨ë¸ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²•</strong>
      <ul>
        <li>ê°ê° í…Œì´ë¸”ë¡œ ë³€í™˜ -&gt; <strong>ì¡°ì¸ ì „ëµ</strong> <img src="../../assets/forPost/JPA_Basic/%EC%A1%B0%EC%9D%B8%20%EC%A0%84%EB%9E%B5.png" alt="TEXT" title="ì¡°ì¸ ì „ëµ" />
          <ul>
            <li>ì•¨ë²” ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ë©´ ITEMê³¼ ALBUMì— insertê°€ ëœë‹¤. (ì¦‰, insert 2ë²ˆ)</li>
            <li>ITEM í…Œì´ë¸”ì˜ DTYPEë¥¼ í†µí•´ ì–´ëŠ í…Œì´ë¸”ê³¼ ì¡°ì¸í• ì§€ êµ¬ë¶„ ê°€ëŠ¥</li>
          </ul>
        </li>
        <li>í†µí•© í…Œì´ë¸”ë¡œ ë³€í™˜ -&gt; <strong>ë‹¨ì¼ í…Œì´ë¸” ì „ëµ</strong> <img src="../../assets/forPost/JPA_Basic/%EB%8B%A8%EC%9D%BC%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%A0%84%EB%9E%B5.png" alt="TEXT" title="ë‹¨ì¸í…Œì´ë¸” ì „ëµ" />
          <ul>
            <li>DTYPEì„ í†µí•´ Album, Movie, Bookì¤‘ ë¬´ì—‡ì¸ì§€ êµ¬ë¶„ ê°€ëŠ¥</li>
          </ul>
        </li>
        <li>ì„œë¸Œíƒ€ì… í…Œì´ë¸”ë¡œ ë³€í™˜ -&gt; <strong>êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ</strong><img src="../../assets/forPost/JPA_Basic/%EA%B5%AC%ED%98%84%20%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A7%88%EB%8B%A4%20%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%A0%84%EB%9E%B5.png" alt="TEXT" title="êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ ì „ëµ" /></li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>ì£¼ìš” ì–´ë…¸í…Œì´ì…˜</strong>
      <ul>
        <li>@Inheritance(strategy = InheritanceType.XXX)
          <ul>
            <li>JOINED : ì¡°ì¸ì „ëµ</li>
            <li>SINGLE_TABLE : ë‹¨ì¼ í…Œì´ë¸” ì „ëµ</li>
            <li>TABLE_PER_CLASS : êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ</li>
          </ul>
        </li>
        <li>@DiscriminatorColumn(name=â€œDTYPEâ€)</li>
        <li>@DiscriminatorValue(â€œXXXâ€)</li>
      </ul>
    </li>
  </ul>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Inheritance</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">InheritanceType</span><span class="o">.</span><span class="na">JOINED</span><span class="o">)</span> <span class="c1">//JOINEDë¥¼ SINGLE_TABLEë¡œ ë°”ê¾¸ë©´ ë‹¨ì¼ í…Œì´ë¸” ì „ëµ</span>
<span class="nd">@DiscriminatorColumn</span>  <span class="c1">// (name = "DIS_TYPE)ì„ ì ìœ¼ë©´ ì»¬ëŸ¼ëª… ë°”ê¾¸ê¸° ê°€ëŠ¥</span>
<span class="c1">//ë‹¨ì¼ í…Œì´ë¸” ì „ëµì€ @DiscriminatorColumn ì•ˆì¨ë„ ìë™ìœ¼ë¡œ DTYPE ìƒì„±ë¨(í•œ í…Œì´ë¸”ì— ë“¤ì–´ê°€ìˆê¸°ë•Œë¬¸ì— DTYPEì´ ì—†ìœ¼ë©´ ë­”ì§€ ì•Œìˆ˜ì—†ë‹¤.)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <ul>
    <li>JPAì˜ ì¥ì  : ì¡°ì¸ í…Œì´ë¸” ì „ëµìœ¼ë¡œ ê°œë°œí•˜ë‹¤ê°€ ë‹¨ì¼ í…Œì´ë¸” ì „ëµìœ¼ë¡œ ë°”ê¿”ì•¼ í•  ê²½ìš° @Inheritance ì–´ë…¸í…Œì´ì…˜ë§Œ ìˆ˜ì •í•˜ë©´ ëœë‹¤</li>
  </ul>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"A"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Album</span> <span class="kd">extends</span> <span class="nc">Item</span><span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">artist</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JpaMain</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">EntityManagerFactory</span> <span class="n">emf</span> <span class="o">=</span> <span class="nc">Persistence</span><span class="o">.</span><span class="na">createEntityManagerFactory</span><span class="o">(</span><span class="s">"hello"</span><span class="o">);</span>

        <span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>

        <span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
        <span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Movie</span> <span class="n">movie</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Movie</span><span class="o">();</span>
            <span class="n">movie</span><span class="o">.</span><span class="na">setDirector</span><span class="o">(</span><span class="s">"aaaa"</span><span class="o">);</span>
            <span class="n">movie</span><span class="o">.</span><span class="na">setActor</span><span class="o">(</span><span class="s">"bbbb"</span><span class="o">);</span>
            <span class="n">movie</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"ë°”ëŒ"</span><span class="o">);</span>
            <span class="n">movie</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">10000</span><span class="o">);</span>

            <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">movie</span><span class="o">);</span><span class="c1">//(ì¡°ì¸ ì „ëµ ì‚¬ìš©ì‹œ insert ë‘ë²ˆ, ë‹¨ì¼í…Œì´ë¸” ì „ëµ ì‚¬ìš©ì‹œ insert í•œë²ˆ)</span>

            <span class="n">em</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
            <span class="n">em</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="c1">//ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì œê±°, 1ì°¨ ìºì‹œ ë¹„ì›€</span>

            <span class="nc">Movie</span> <span class="n">findMovie</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Movie</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">movie</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span> <span class="c1">//ì‹¤í–‰ì‹œ ì½˜ì†”ì— ì¿¼ë¦¬ê°€ ë‚˜ì˜¨ë‹¤. (ì¡°ì¸ ì „ëµì€ ì¡°ì¸ ì‚¬ìš©)</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMovie = "</span> <span class="o">+</span> <span class="n">findMovie</span><span class="o">);</span>

            <span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
        <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">tx</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span>
        <span class="o">}</span><span class="k">finally</span> <span class="o">{</span>
            <span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">emf</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>ì¡°ì¸ ì „ëµ ì‹¤í–‰ê²°ê³¼</strong> <br />
<img src="../../assets/forPost/JPA_Basic/%EC%A1%B0%EC%9D%B8%20%EC%A0%84%EB%9E%B5%20DB.png" alt="TEXT" title="ì¡°ì¸ ì „ëµ DB" /> <br />
ITEM í…Œì´ë¸”ê³¼ MOVIE í…Œì´ë¸”ì˜ IDëŠ” ë˜‘ê°™ë‹¤. (ITEMì˜ IDëŠ” PK, MOVIEì˜ IDëŠ” PK,FK) <br />
DTYPEì˜ Mì€ Movie (@DiscriminatorValueì„ ì‚¬ìš©) <br /></p>

<blockquote>
  <ul>
    <li><strong>ì¥ì </strong>
      <ul>
        <li>í…Œì´ë¸” ì •ê·œí™”</li>
        <li>ì™¸ë˜ í‚¤ ì°¸ì¡° ë¬´ê²°ì„± ì œì•½ì¡°ê±´ í™œìš©ê°€ëŠ¥ (ITEM_ID ì‚¬ìš©, ì„¤ê³„ê°€ ê¹”ë”í•´ì§)</li>
        <li>ì €ì¥ê³µê°„ íš¨ìœ¨í™” (ì •ê·œí™”ê°€ ë˜ì–´ìˆê¸° ë•Œë¬¸ì—)</li>
      </ul>
    </li>
    <li><strong>ë‹¨ì </strong>
      <ul>
        <li>ì¡°íšŒì‹œ ì¡°ì¸ì„ ë§ì´ ì‚¬ìš©, ì„±ëŠ¥ ì €í•˜ (ì¡°ì¸ì„ ì˜ í•˜ë©´ ì„±ëŠ¥ì €í•˜ í¬ê²Œ ë°œìƒ ì•ˆí•¨, ì €ì¥ê³µê°„ì´ íš¨ìœ¨í™” ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ì˜¤íˆë ¤ ì„±ëŠ¥ì´ ì˜ ë‚˜ì˜¬ìˆ˜ë„ ìˆë‹¤)</li>
        <li>ì¡°íšŒ ì¿¼ë¦¬ê°€ ë³µì¡í•¨</li>
        <li>ë°ì´í„° ì €ì¥ì‹œ INSERT SQL 2ë²ˆ í˜¸ì¶œ</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li>ì¡°ì¸ì „ëµì´ <strong>ì •ì„</strong>ì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.</li>
    <li>ê°ì²´ì™€ë„ ì˜ ë§ê³  ì •ê·œí™”ë„ ë˜ê³  ê¹”ë”í•˜ê²Œ ì„¤ê³„ ê°€ëŠ¥</li>
    <li>ë‹¨ì¼ í…Œì´ë¸”ì— ë¹„í•´ì„œëŠ” <strong>ë³µì¡</strong>í•˜ë‹¤</li>
  </ul>
</blockquote>

<p><strong>ë‹¨ì¼ í…Œì´ë¸” ì „ëµ ì‹¤í–‰ê²°ê³¼</strong> <br />
<img src="../../assets/forPost/JPA_Basic/%EB%8B%A8%EC%9D%BC%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%A0%84%EB%9E%B5%20DB.png" alt="TEXT" title="ë‹¨ì¼í…Œì´ë¸” ì „ëµ DB" /> <br /></p>

<blockquote>
  <ul>
    <li><strong>ì¥ì </strong>
      <ul>
        <li>ì¡°ì¸ì´ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ ì¡°íšŒ ì„±ëŠ¥ì´ ë¹ ë¦„</li>
        <li>ì¡°íšŒ ì¿¼ë¦¬ê°€ ë‹¨ìˆœí•¨</li>
      </ul>
    </li>
    <li><strong>ë‹¨ì </strong>
      <ul>
        <li>ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ null í—ˆìš© (ë°ì´í„° ë¬´ê²°ì„± ì…ì¥ì• ì„œëŠ” ì• ë§¤í•œê²Œ ìˆë‹¤)</li>
        <li>ë‹¨ì¼ í…Œì´ë¸”ì— ëª¨ë“  ê²ƒì„ ì €ì¥í•˜ë¯€ë¡œ í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆë‹¤. ìƒí™©ì— ë”°ë¼ì„œ ì¡°íšŒ ì„±ëŠ¥ì´ ì˜¤íˆë ¤ ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤. (ì›¬ë§Œí•´ì„œëŠ” ì„ê³„ì ì„ ë„˜ì„ ê²½ìš°ê°€ ê±°ì˜ ì—†ë‹¤.)</li>
      </ul>
    </li>
  </ul>
</blockquote>

<p><strong>êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ ê²°ê³¼</strong> <br />
<img src="../../assets/forPost/JPA_Basic/%EA%B5%AC%ED%98%84%20%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A7%88%EB%8B%A4%20%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%A0%84%EB%9E%B5%20DB.png" alt="TEXT" title="êµ¬í˜„í´ë˜ìŠ¤ë§ˆë‹¤" /> <br />
ITEM í…Œì´ë¸”ì€ ì•ˆë§Œë“¤ì–´ì§„ë‹¤. <br />
êµ¬ë¶„í•  í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— DTYPEë„ ì•ˆë§Œë“¤ì–´ì§„ë‹¤. <br />
ì¿¼ë¦¬ë„ ì‹¬í”Œí•˜ê²Œ ë“¤ì–´ê°€ì„œ ì¢‹ì€ê²ƒ ê°™ì§€ë§Œ ë°ì´í„°ë¥¼ ì°¾ì„ë•Œ í° ë¬¸ì œ ë°œìƒ. <br />
ex) ITEM_IDë§Œ ì•Œ ê²½ìš°, ëª¨ë“  í…Œì´ë¸”ì—ì„œ ì°¾ì•„ì„œ(selectì‹œ union ì‚¬ìš©) ë§¤ìš° ë¹„íš¨ìœ¨ì ì´ë‹¤.<br /></p>

<blockquote>
  <ul>
    <li><strong>ì´ ì „ëµì€ DB ì„¤ê³„ìì™€ ORM ì „ë¬¸ê°€ ë‘˜ ë‹¤ ì¶”ì²œ X</strong></li>
    <li>ì¥ì 
      <ul>
        <li>ì„œë¸Œ íƒ€ì…ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ íš¨ê³¼ì </li>
        <li>not null ì œì•½ì¡°ê±´ ì‚¬ìš© ê°€ëŠ¥</li>
      </ul>
    </li>
    <li>ë‹¨ì 
      <ul>
        <li>ì—¬ëŸ¬ ìì‹ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ì´ ëŠë¦¼(UNION SQL í•„ìš”)</li>
        <li>ìì‹ í…Œì´ë¸”ì„ í†µí•©í•´ì„œ ì¿¼ë¦¬í•˜ê¸° ì–´ë ¤ì›€</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li>í…Œì´ë¸”ì´ ë¬¶ì´ëŠ”ê²Œ ì—†ê¸° ë•Œë¬¸ì— ì „ë¶€ ë‹¤ ì¡°íšŒí•´ì•¼í•¨</li>
    <li>ìƒˆë¡œìš´ íƒ€ì…ì„ ì¶”ê°€í• ë•Œ ë³€ê²½í• ê²Œ êµ‰ì¥íˆ ë§ì•„ì§„ë‹¤.</li>
    <li>ì´ ì „ëµì„ ì‚¬ìš©í•  ê²½ìš° ë¨¼ ë¯¸ë˜ì— ì–¸ì  ê°€ëŠ” í° í›„íšŒë¥¼ í•œë‹¤.</li>
  </ul>
</blockquote>

<h4 id="ì–¸ì œ-ë­˜-ì‚¬ìš©í• ê¹Œ">ì–¸ì œ ë­˜ ì‚¬ìš©í• ê¹Œ?</h4>

<blockquote>
  <ul>
    <li>ë³´í†µ ì¡°ì¸ ì „ëµì„ ì„ íƒ, ì—„ì²­ ë‹¨ìˆœí•˜ê³  í™•ì¥í•  ì¼ë„ ì—†ì„ ê²½ìš° ë‹¨ì¼í…Œì´ë¸” ì „ëµ ì„ íƒ</li>
  </ul>
</blockquote>

<h3 id="2-mapped-superclass---ë§¤í•‘-ì •ë³´-ìƒì†">2. Mapped Superclass - ë§¤í•‘ ì •ë³´ ìƒì†</h3>

<blockquote>
  <ul>
    <li>ê³µí†µ ë§¤í•‘ ì •ë³´ê°€ í•„ìš”í•  ë•Œ ì‚¬ìš©(id, name)</li>
  </ul>
</blockquote>

<p><strong>ex)</strong> ê°ì²´ ì…ì¥ì—ì„œ id, name í•„ë“œê°€ ê³„ì† ë‚˜ì˜¬ ë•Œ, í´ë˜ìŠ¤ ë§Œë“¤ë•Œ ë§ˆë‹¤ id, name í•„ë“œë¥¼ ìƒì„±í•˜ê¸° ê·€ì°®ìœ¼ë‹ˆê¹Œ ë¶€ëª¨ í´ë˜ìŠ¤ì— ë‘ê³  ì†ì„±ë§Œ ìƒì†í•´ì„œ ì‚¬ìš©í•˜ê³  ì‹¶ì€ê²½ìš° <br />
DBëŠ” ì™„ì „íˆ ë‹¤ë¥¸ë°, ê°ì²´ ì…ì¥ì—ì„œ ì†ì„±ë§Œ ìƒì†ë°›ì•„ì„œ ì“°ê³ ì‹¶ì€ ê²½ìš° <br />
ì¦‰, ê·€ì°®ì•„ì„œ ê·€ì°®ìŒì„ ì¤„ì¼ ë•Œ ì‚¬ìš©</p>

<p><img src="../../assets/forPost/JPA_Basic/MappedSuperclass%EC%82%AC%EC%9A%A9.png" alt="TEXT" title="MappedSuperclass ì‚¬ìš©" /></p>

<p><strong>ex)</strong> ëª¨ë“  í…Œì´ë¸”ì—ì„œ ëˆ„ê°€, ì–¸ì œ ë“±ë¡, ìˆ˜ì •í–ˆëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ê°€ í•­ìƒ ìˆì–´ì•¼ í•  ê²½ìš°</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
private String createdBy;
private LocalDateTime createdDate;
private String lastModifiedBy;
private LocalDateTime lastModifiedDate;
MappedSuperclassë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì´ ì½”ë“œë¥¼ ëª¨ë“  í…Œì´ë¸”ì— ì‘ì„±í•´ì•¼í•œë‹¤.*/</span>
<span class="c1">//MappedSuperclassë¥¼ ì‚¬ìš©í•˜ë©´ ìƒì†ë°›ì•„ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</span>
<span class="nd">@MappedSuperclass</span> <span class="c1">//ë§¤í•‘ ì •ë³´ë§Œ ë°›ëŠ” ë¶€ëª¨ í´ë˜ìŠ¤</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">BaseEntity</span> <span class="o">{</span>

    <span class="c1">//@Column(name = "INSERT_MEMBER") ì»¬ëŸ¼ ì´ë¦„ ë³€ê²½ì‹œ ì‚¬ìš©</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">createdBy</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdDate</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastModifiedBy</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">lastModifiedDate</span><span class="o">;</span>

    <span class="c1">//getter setter ìƒëµ</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span><span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMEBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"USERNAME"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//JpaMainì˜ try ë‚´ë¶€ ì½”ë“œ</span>
<span class="k">try</span> <span class="o">{</span>

            <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
            <span class="n">member</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"user1"</span><span class="o">);</span>
            <span class="n">member</span><span class="o">.</span><span class="na">setCreatedBy</span><span class="o">(</span><span class="s">"kim"</span><span class="o">);</span>
            <span class="n">member</span><span class="o">.</span><span class="na">setCreatedDate</span><span class="o">(</span><span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>

            <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

            <span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
     <span class="o">}</span>

</code></pre></div></div>

<blockquote>
  <ul>
    <li><strong>ìƒì†ê´€ê³„ ë§¤í•‘ X</strong></li>
    <li><strong>ì—”í‹°í‹° X, í…Œì´ë¸”ê³¼ ë§¤í•‘ X</strong>(ì†ì„±ë§Œ ë‚´ë ¤ì£¼ëŠ”ì• )</li>
    <li><strong>ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ëŠ” ìì‹ í´ë˜ìŠ¤ì— ë§¤í•‘ ì •ë³´ë§Œ ì œê³µ</strong></li>
    <li><strong>ì¡°íšŒ, ê²€ìƒ‰ ë¶ˆê°€</strong> (em.find(BaseEntity.class) ë¶ˆê°€ëŠ¥)</li>
    <li><strong>ì§ì ‘ ìƒì„±í•´ì„œ ì‚¬ìš©í•  ì¼ì´ ì—†ìœ¼ë¯€ë¡œ ì¶”ìƒ í´ë˜ìŠ¤ ê¶Œì¥</strong></li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li>í…Œì´ë¸”ê³¼ ê´€ê³„ ì—†ê³ , ë‹¨ìˆœíˆ ì—”í‹°í‹°ê°€ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë§¤í•‘ ì •ë³´ë¥¼ ëª¨ìœ¼ëŠ” ì—­í• </li>
    <li>ì£¼ë¡œ ë“±ë¡ì¼, ìˆ˜ì •ì¼, ë“±ë¡ì, ìˆ˜ì •ì ê°™ì€ ì „ì²´ ì—”í‹°í‹°ì—ì„œ ê³µí†µìœ¼ë¡œ ì ìš©í•˜ëŠ” ì •ë³´ë¥¼ ëª¨ì„ ë•Œ ì‚¬ìš©</li>
    <li><strong>ì°¸ê³ </strong> : @Entity í´ë˜ìŠ¤ëŠ” ì—”í‹°í‹°ë‚˜ @MappedSuperclassë¡œ ì§€ì •í•œ í´ë˜ìŠ¤ë§Œ ìƒì† ê°€ëŠ¥ (JPAì—ì„œ extendsë¥¼ ì‚¬ìš©í• ë•Œ)</li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li>ì‹¤ë¬´ì—ì„œ BaseEntityë¥¼ ë§Œë“¤ì–´ì„œ í™œìš©í•˜ë©´ í¸ë¦¬í•˜ë‹¤.</li>
  </ul>
</blockquote>

<h2 id="í”„ë¡ì‹œì™€-ì—°ê´€ê´€ê³„-ê´€ë¦¬">í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„ ê´€ë¦¬</h2>

<h3 id="1-í”„ë¡ì‹œ">1. í”„ë¡ì‹œ</h3>

<blockquote>
  <ul>
    <li><strong>í”„ë¡ì‹œ ì‚¬ìš© ì´ìœ ?</strong>
      <ul>
        <li>Memeber í…Œì´ë¸”ê³¼ Team í…Œì´ë¸”ì´ ì—°ê´€ê´€ê³„ë¥¼ ê°€ì§ˆ ë•Œ, í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì„œ ì§€ì—°ë¡œë”©ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ë©´ Memberë¥¼ JPAë¥¼ í†µí•´ ì¡°íšŒí•  ë•Œ ì—°ê´€ê´€ê³„ì¸ Teamê¹Œì§€ í•¨ê»˜ ì¡°íšŒëœë‹¤. <br /> ì—¬ê¸°ì„œ ë¬¸ì œê°€ ë˜ëŠ” ì´ìœ ëŠ” Memberë§Œ í•„ìš”í•œë° ì—°ê´€ê´€ê³„ì¸ Teamê¹Œì§€ ë‹¤ ë¶ˆëŸ¬ì™€ì„œ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì™€ìˆê¸° ë•Œë¬¸ì— <strong>ë¦¬ì†ŒìŠ¤ ë‚­ë¹„</strong>ê°€ ìƒê¸´ë‹¤. <br /> ë§Œì•½ í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì—°ë¡œë”©ì´ ê°€ëŠ¥í•´ì§€ë©´ Teamì„ ì§€ì—°ë¡œë”©ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³ (Teamì€ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šê²Œ ë¨) Memberë§Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆê²Œëœë‹¤. <br /> ì´ ê³¼ì •ì—ì„œ Teamì„ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šê¸° ë•Œë¬¸ì— <strong>ë¦¬ì†ŒìŠ¤ì˜ ë‚­ë¹„ë¥¼ ì¡°ê¸ˆì´ë¼ë„ ì¤„ì¼ ìˆ˜ ìˆë‹¤.</strong> ì´ëŸ¬í•œ ì§€ì—°ë¡œë”©ì´ë¼ëŠ” ê¸°ìˆ ì„ ê°€ëŠ¥ì¼€ í•˜ëŠ”ê²Œ í”„ë¡ì‹œì´ë‹¤.</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>í”„ë¡ì‹œì˜ ê¸°ì´ˆ</strong>
      <ul>
        <li>em.find() vs em.getReference();
          <ul>
            <li>em.find() : ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ (ì¿¼ë¦¬ê°€ ë‚˜ê°)</li>
            <li>em.getReference() : ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒë¥¼ ë¯¸ë£¨ëŠ” ê°€ì§œ(í”„ë¡ì‹œ) ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ (ì¿¼ë¦¬ê°€ ì•ˆë‚˜ê°)</li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</blockquote>

<p><img src="../../assets/forPost/JPA_Basic/em.getReference().png" alt="TEXT" title="em.getReference" /></p>

<blockquote>
  <ul>
    <li><strong>í”„ë¡ì‹œ íŠ¹ì§• 1</strong>
      <ul>
        <li>ì‹¤ì œ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì§</li>
        <li>ì‹¤ì œ í´ë˜ìŠ¤ì™€ ê²‰ ëª¨ì–‘ì´ ê°™ë‹¤.</li>
        <li>ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œëŠ” ì§„ì§œ ê°ì²´ì¸ì§€ í”„ë¡¤ì‹œ ê°ì²´ì¸ì§€ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì‚¬ìš©í•˜ë©´ ë¨ (ì´ë¡ ìƒ)</li>
        <li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ì°¸ì¡°(target)ë¥¼ ë³´ê´€</li>
        <li>í”„ë¡ì‹œ ê°ì²´ë¥¼ í˜¸ì¶œí•˜ë©´ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ë©”ì†Œë“œ í˜¸ì¶œ</li>
      </ul>
    </li>
  </ul>
</blockquote>

<p><img src="../../assets/forPost/JPA_Basic/%ED%94%84%EB%A1%9D%EC%8B%9C%20%ED%8A%B9%EC%A7%951.png" alt="TEXT" title="í”„ë¡ì‹œ íŠ¹ì§•" width="20%" height="20%" />
<img src="../../assets/forPost/JPA_Basic/%ED%94%84%EB%A1%9D%EC%8B%9C%20%ED%8A%B9%EC%A7%952.png" alt="TEXT" title="í”„ë¡ì‹œ íŠ¹ì§•" width="60%" height="80%" /></p>

<blockquote>
  <ul>
    <li><strong>í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”</strong></li>
  </ul>
</blockquote>

<p><img src="../../assets/forPost/JPA_Basic/%ED%94%84%EB%A1%9D%EC%8B%9C%20%EA%B0%9D%EC%B2%B4%EC%9D%98%20%EC%B4%88%EA%B8%B0%ED%99%94.png" alt="TEXT" title="í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”" /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span><span class="o">{</span>
    <span class="c1">// Member findMember = em.find(Member.class, member.getId()); //ì¿¼ë¦¬ ë‚˜ê°</span>
    <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span> <span class="c1">//getReferenceë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì—ëŠ” ì¿¼ë¦¬ ì•ˆë‚˜ê°</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMember = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">// ì¶œë ¥ê²°ê³¼ : hellojpa.Member$HibernateProxy$odcVHpjy  (Hibernateê°€ ê°•ì œë¡œ ë§Œë“  ê°€ì§œ í´ë˜ìŠ¤(í”„ë¡ì‹œ))</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMember.id = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span> <span class="c1">// ì•„ì§ ì¿¼ë¦¬ ì•ˆë‚˜ê°, Referenceë¥¼ ì°¾ì„ë•Œ getIdë¥¼ ë„£ì—ˆê¸° ë•Œë¬¸ì— ì¦‰, ì´ë¯¸ ê°’ì´ ìˆê¸° ë•Œë¬¸ì— ì¿¼ë¦¬ê°€ ì•ˆë‚˜ê°</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMember.username = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span> <span class="c1">// ì¿¼ë¦¬ ë‚˜ê°, findMemberì— ê°’ì„ ì±„ì›Œì•¼ í•˜ê¸° ë•Œë¬¸ì— ì¿¼ë¦¬ê°€ ë‚˜ê°„ë‹¤.</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMember.username = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span> <span class="c1">// í•œë²ˆ ë” í˜¸ì¶œ ì‹œ, ë°”ë¡œ ìœ„ì—ì„œ ì´ë¯¸ ì´ˆê¸°í™” ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ê°’ë§Œ ì¶œë ¥ë¨</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <ul>
    <li><strong>í”„ë¡ì‹œ íŠ¹ì§• 2</strong>
      <ul>
        <li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì²˜ìŒ ì‚¬ìš©í•  ë•Œ <strong>í•œ ë²ˆë§Œ ì´ˆê¸°í™”</strong></li>
        <li>í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™” í•  ë•Œ, <strong>í”„ë¡ì‹œ ê°ì²´ê°€ ì‹¤ì œ ì—”í‹°í‹°ë¡œ ë°”ë€ŒëŠ” ê²ƒì€ ì•„ë‹˜</strong>, ì´ˆê¸°í™”ë˜ë©´ í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ì„œ <strong>ì‹¤ì œ ì—”í‹°í‹°ì— ì ‘ê·¼ ê°€ëŠ¥</strong></li>
        <li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ ì—”í‹°í‹°ë¥¼ ìƒì†ë°›ìŒ, ë”°ë¼ì„œ íƒ€ì… ì²´í¬ì‹œ ì£¼ì˜í•´ì•¼í•¨(==ë¹„êµ ì‹¤íŒ¨, ëŒ€ì‹  <strong>instance of ì‚¬ìš©</strong>)</li>
        <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì°¾ëŠ” ì—”í‹°í‹°ê°€ ì´ë¯¸ ìˆìœ¼ë©´ em.getReference()ë¥¼ í˜¸ì¶œí•´ë„ ì‹¤ì œ ì—”í‹°í‹° ë°˜í™˜</li>
        <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†ëŠ” ì¤€ ì˜ì† ìƒíƒœì¼ ë•Œ, í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™”í•˜ë©´ ë¬¸ì œ ë°œìƒ (HibernateëŠ” org.hibernate.LazyInitializationException ì˜ˆì™¸ë¥¼ í„°íŠ¸ë¦¼)</li>
      </ul>
    </li>
  </ul>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"before findMember = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member$HibernateProxy$odcVHpjy</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMember.username = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"after findMember = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member$HibernateProxy$odcVHpjy</span>
<span class="c1">// êµì²´ë˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ í”„ë¡ì‹œëŠ” ìœ ì§€ê°€ ë˜ê³  ë‚´ë¶€ì˜ íƒ€ê²Ÿì—ë§Œ ê°’ì´ ì±„ì›Œì§€ëŠ”ê²ƒì´ë‹¤.</span>
<span class="c1">//==========================================================================================================================</span>
<span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
<span class="n">member1</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"member1"</span><span class="o">);</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span>
<span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
<span class="n">member1</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"member2"</span><span class="o">);</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>

<span class="nc">Member</span> <span class="n">m1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">Member</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member2</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m1 == m2: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">m1</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">m2</span><span class="o">.</span><span class="na">getClass</span><span class="o">()));</span> <span class="c1">//falseê°€ ë‚˜ì˜¨ë‹¤.</span>
<span class="n">logic</span><span class="o">(</span><span class="n">m1</span><span class="o">,</span><span class="n">m2</span><span class="o">);</span>
<span class="c1">//ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œëŠ” ë©”ì†Œë“œë¡œ íŒŒë¼ë¯¸í„°ë§Œ ë„˜ì–´ì˜¤ê¸° ë•Œë¬¸ì— í”„ë¡ì‹œê°€ ë„˜ì–´ì˜¤ëŠ”ì§€ ì‹¤ì œë¡œ ë„˜ì–´ì˜¤ëŠ”ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— == ë¹„êµë¥¼ í•˜ë©´ ì•ˆëœë‹¤.</span>
<span class="c1">//ex</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">logic</span><span class="o">(</span><span class="nc">Member</span> <span class="n">m1</span><span class="o">,</span> <span class="nc">Member</span> <span class="n">m2</span><span class="o">){</span>
    <span class="c1">//System.out.println("m1 == m2: " + (m1.getClass() == m2.getClass()));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m1 == m2: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">m1</span> <span class="k">instanceof</span> <span class="nc">Member</span><span class="o">));</span> <span class="c1">//true</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m1 == m2: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">m2</span> <span class="k">instanceof</span> <span class="nc">Member</span><span class="o">));</span> <span class="c1">//true</span>
<span class="o">}</span>
<span class="c1">//==========================================================================================================================</span>
<span class="nc">Member</span> <span class="n">m1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m1 = "</span> <span class="o">+</span> <span class="n">m1</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member</span>

<span class="nc">Member</span> <span class="n">reference</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"reference = "</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member</span>
<span class="cm">/* Referenceë¥¼ í–ˆëŠ”ë° í”„ë¡ì‹œë¡œ ì•ˆë‚˜ì˜¤ëŠ” ì´ìœ 
1. memberë¥¼ ì´ë¯¸ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì˜¬ë ¤ë†¨ëŠ”ë° êµ³ì´ í”„ë¡ì‹œë¡œ ê°€ì ¸ì™€ë´ì•¼ ì´ì ì´ ì—†ë‹¤.
2. JPAì—ì„œëŠ” ë™ì¼í•œ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì—”í‹°í‹°ì˜ ë™ì¼ì„±ì„ ë³´ì¥í•˜ê¸° ë•Œë¬¸ì— íƒ€ì… ë¹„êµë¥¼ í•˜ë©´ trueë¡œ ë‚˜ì˜¨ë‹¤.
*/</span>
<span class="c1">//==========================================================================================================================</span>
<span class="nc">Member</span> <span class="n">m1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m1 = "</span> <span class="o">+</span> <span class="n">m1</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member$HibernateProxy$mnqWhnB</span>

<span class="nc">Member</span> <span class="n">reference</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"reference = "</span> <span class="o">+</span> <span class="n">reference</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member$HibernateProxy$mnqWhnB</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m1 == reference: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">m1</span> <span class="o">==</span> <span class="n">reference</span><span class="o">));</span> <span class="c1">// true</span>
<span class="cm">/* ê°™ì€ í”„ë¡ì‹œê°€ ë°˜í™˜ëœ ì´ìœ ?
ë™ì¼í•œ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì—”í‹°í‹°ì˜ ë™ì¼ì„± ë³´ì¥
*/</span>
<span class="c1">//==========================================================================================================================</span>
<span class="nc">Member</span> <span class="n">refMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"refMember = "</span> <span class="o">+</span> <span class="n">refMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member$HibernateProxy$mnqWhnB</span>

<span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span> <span class="c1">//ì‹¤ì œ ì¡°íšŒë¥¼ í•˜ê¸° ë•Œë¬¸ì— ì¿¼ë¦¬ ë‚˜ê°</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMember = "</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//ì¶œë ¥ê²°ê³¼ : hellojpa.Member$HibernateProxy$mnqWhnB</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"refMember == findMember: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">refMember</span> <span class="o">==</span> <span class="n">findMember</span><span class="o">));</span> <span class="c1">// true</span>
<span class="cm">/* findì—ì„œë„ í”„ë¡ì‹œê°€ ë°˜í™˜ëœ ì´ìœ ?
ë™ì¼í•œ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì—”í‹°í‹°ì˜ ë™ì¼ì„± ë³´ì¥
*/</span>
<span class="c1">//===========================================================================================================================</span>
<span class="nc">Member</span> <span class="n">refMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"refMember = "</span> <span class="o">+</span> <span class="n">refMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//í”„ë¡ì‹œ</span>

<span class="c1">//em.close //ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì¢…ë£Œ</span>
<span class="n">em</span><span class="o">.</span><span class="na">detach</span><span class="o">(</span><span class="n">refMember</span><span class="o">);</span> <span class="c1">//ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬ ì•ˆí•¨</span>
<span class="c1">//em.clear //ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì´ˆê¸°í™” ë˜ë¯€ë¡œ ë˜‘ê°™ì´ ì—ëŸ¬ê°€ ë°œìƒ</span>

<span class="n">refMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">();</span> <span class="c1">//ìœ„ì˜ 3ê°€ì§€ ëª¨ë‘ org.hibernate.LazyInitializationException ì—ëŸ¬ ë°œìƒ</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"refMember = "</span> <span class="o">+</span> <span class="n">refMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span>
</code></pre></div></div>

<blockquote>
  <ul>
    <li>í”„ë¡ì‹œë“  ì•„ë‹ˆë“  <strong>ê°œë°œì— ë¬¸ì œê°€ ì—†ê²Œ ê°œë°œ</strong>í•´ì•¼ ëœë‹¤.</li>
    <li>ì‹¤ë¬´ì—ì„œ <strong>org.hibernate.LazyInitializationException</strong>ì´ <strong>ë§ì´ ë°œìƒ</strong>í•˜ë¯€ë¡œ <strong>ì£¼ì˜</strong>í•˜ì.</li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>í”„ë¡ì‹œ í™•ì¸</strong>
      <ul>
        <li>í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ì˜ ì´ˆê¸°í™” ì—¬ë¶€ í™•ì¸
          <ul>
            <li>PersistenceUnitUtil.isLoaded(Object entity)</li>
          </ul>
        </li>
        <li>í”„ë¡ì‹œ í´ë˜ìŠ¤ í™•ì¸ ë°©ë²•
          <ul>
            <li>entity.getClass().getName() ì¶œë ¥(..javasist.. or HibernateProxyâ€¦)</li>
          </ul>
        </li>
        <li>í”„ë¡ì‹œ ê°•ì œ ì´ˆê¸°í™”
          <ul>
            <li>org.hibernate.Hibernate.initialize(entity);</li>
          </ul>
        </li>
        <li>ì°¸ê³  : JPA í‘œì¤€ì€ ê°•ì œ ì´ˆê¸°í™” ì—†ìŒ <br /> ê°•ì œ í˜¸ì¶œ : member.getName();</li>
      </ul>
    </li>
  </ul>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">refMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"refMember = "</span> <span class="o">+</span> <span class="n">refMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">//í”„ë¡ì‹œ</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"isLoaded = "</span> <span class="o">+</span> <span class="n">emf</span><span class="o">.</span><span class="na">getPersistenceUnitUtil</span><span class="o">().</span><span class="na">isLoaded</span><span class="o">(</span><span class="n">refMember</span><span class="o">));</span> <span class="c1">//ì¶œë ¥ ê²°ê³¼ : false</span>

<span class="n">refMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">();</span> <span class="c1">//ê°•ì œ ì´ˆê¸°í™”</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"isLoaded = "</span> <span class="o">+</span> <span class="n">emf</span><span class="o">.</span><span class="na">getPersistenceUnitUtil</span><span class="o">().</span><span class="na">isLoaded</span><span class="o">(</span><span class="n">refMember</span><span class="o">));</span> <span class="c1">//ì¶œë ¥ ê²°ê³¼ : true</span>

<span class="nc">Hibernate</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="n">refMember</span><span class="o">);</span> <span class="c1">//ê°•ì œ ì´ˆê¸°í™”</span>
</code></pre></div></div>

<h3 id="2-ì¦‰ì‹œ-ë¡œë”©ê³¼-ì§€ì—°-ë¡œë”©">2. ì¦‰ì‹œ ë¡œë”©ê³¼ ì§€ì—° ë¡œë”©</h3>

<blockquote>
  <ul>
    <li>ì§€ì—°ë¡œë”© <strong>LAZYë¥¼ ì‚¬ìš©</strong>í•´ì„œ í”„ë¡ì‹œë¡œ ì¡°íšŒ</li>
  </ul>
</blockquote>

<p><img src="../../assets/forPost/JPA_Basic/%EC%A7%80%EC%97%B0%EB%A1%9C%EB%94%A9.png" alt="TEXT" title="ì§€ì—°ë¡œë”©" />
<img src="../../assets/forPost/JPA_Basic/%EC%A7%80%EC%97%B0%EB%A1%9C%EB%94%A9%20LAZY.png" alt="TEXT" title="ì§€ì—°ë¡œë”© LAZY" /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMEBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"USERNAME"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>
<span class="o">}</span>

<span class="nc">JpaMainì˜</span> <span class="k">try</span> <span class="n">ë‚´ë¶€</span>
<span class="k">try</span><span class="o">{</span>
    <span class="nc">Member</span> <span class="n">m</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span><span class="c1">//Memberë§Œ ê°€ì ¸ì˜´</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m = "</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="na">getTeam</span><span class="o">().</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">// í”„ë¡ì‹œë¡œ ë‚˜ì˜´</span>
    <span class="n">m</span><span class="o">.</span><span class="na">getTeam</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span> <span class="c1">//ì´ë•Œ TEAMì— ëŒ€í•œ ì¿¼ë¦¬ê°€ ë‚˜ì˜´, ì´ˆê¸°í™”</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <ul>
    <li><strong>Memberì™€ Teamì„ ìì£¼ í•¨ê»˜ ì‚¬ìš©í•œë‹¤ë©´?</strong>
      <ul>
        <li>LAZYë¥¼ ì‚¬ìš©í•˜ë©´ Member ë”°ë¡œ Team ë”°ë¡œ ì¿¼ë¦¬ê°€ ê°ê° ë‚˜ê°€ì„œ ì„±ëŠ¥ìƒ ì†í•´ë¥¼ ë³¸ë‹¤.</li>
        <li>ì¦‰ì‹œ ë¡œë”© EAGERë¥¼ ì‚¬ìš©í•´ì„œ í•¨ê»˜ ì¡°íšŒ</li>
      </ul>
    </li>
  </ul>
</blockquote>

<p><img src="../../assets/forPost/JPA_Basic/%EC%A6%89%EC%8B%9C%EB%A1%9C%EB%94%A9.png" alt="TEXT" title="ì¦‰ì‹œë¡œë”©" />
<img src="../../assets/forPost/JPA_Basic/%EC%A6%89%EC%8B%9C%EB%A1%9C%EB%94%A9%20EAGER.png" alt="TEXT" title="ì¦‰ì‹œë¡œë”© EAGER" /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMEBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"USERNAME"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>
<span class="o">}</span>

<span class="nc">JpaMainì˜</span> <span class="k">try</span> <span class="n">ë‚´ë¶€</span>
<span class="k">try</span><span class="o">{</span>
    <span class="nc">Member</span> <span class="n">m</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span> <span class="c1">//ì¡°íšŒë¥¼ í• ëŒ€ joinì„ ì‚¬ìš©í•´ì„œ í•œë°©ì— ì¿¼ë¦¬ë¥¼ ë‚ ë¦¼</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"m = "</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="na">getTeam</span><span class="o">().</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">// í”„ë¡ì‹œê°€ ì•„ë‹Œ hellojpa.Teamê°€ ë‚˜ì˜´</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"teamName = "</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="na">getTeam</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span> <span class="c1">//teamA</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <ul>
    <li><strong>í”„ë¡ì‹œì™€ ì¦‰ì‹œë¡œë”© ì£¼ì˜</strong>
      <ul>
        <li><strong>ê°€ê¸‰ì  ì§€ì—° ë¡œë”©ë§Œ ì‚¬ìš©</strong>(ì‹¤ë¬´ì—ì„œëŠ” ì¦‰ì‹œ ë¡œë”© ì‚¬ìš©í•˜ë©´ ì•ˆë¨)</li>
        <li>ì¦‰ì‹œ ë¡œë”©ì„ ì ìš©í•˜ë©´ <strong>ì˜ˆìƒí•˜ì§€ ëª»í•œ SQLì´ ë°œìƒ</strong>
          <ul>
            <li>í…Œì´ë¸”ì´ ì—¬ëŸ¬ê°œë©´ joinë„ ì—¬ëŸ¬ê°œ ë‚˜ì™€ì„œ <strong>ì„±ëŠ¥ì´ ì €í•˜</strong>ë˜ê³  ì¿¼ë¦¬ë„ ì—„ì²­ ê¸¸ê²Œ ë‚˜ì˜¨ë‹¤.</li>
          </ul>
        </li>
        <li>ì¦‰ì‹œ ë¡œë”©ì€ JPQLì—ì„œ <strong>N+1 ë¬¸ì œ</strong>ë¥¼ ì¼ìœ¼í‚¨ë‹¤.
          <ul>
            <li>JPQLë¡œ Member ì¡°íšŒí•  ê²½ìš°, Memberì— Teamì´ EAGERë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ Teamë„ ê°™ì´ ê°€ì ¸ì˜¨ë‹¤</li>
            <li>ìµœì´ˆ ì¿¼ë¦¬ê°€ 1ê°œ ë‚˜ê°€ê³  ì¶”ê°€ë¡œ Nê°œì˜ ì¿¼ë¦¬ê°€ ë‚˜ê°„ë‹¤</li>
          </ul>
        </li>
        <li>@ManyToOne, @OneToOneì€ ê¸°ë³¸ì´ ì¦‰ì‹œ ë¡œë”© -&gt; LAZYë¡œ ì„¤ì •í•˜ì</li>
        <li>@OneToMany, @ManyToManyëŠ” ê¸°ë³¸ì´ ì§€ì—° ë¡œë”©</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>ì‹¤ë¬´ì—ì„œëŠ”?</strong>
      <ul>
        <li>ëª¨ë“  ì—°ê´€ê´€ê³„ì— <strong>ì§€ì—° ë¡œë”©ìœ¼ë¡œ ì„¤ì •</strong></li>
        <li><strong>ì‹¤ë¬´ì—ì„œ ì¦‰ì‹œ ë¡œë”© ì‚¬ìš©í•˜ì§€ ë§ê²ƒ!</strong></li>
        <li>JPQL fetch join ì‚¬ìš© (ë°ì´í„°ê°€ ì±„ì›Œì§€ê¸° ë•Œë¬¸ì— ë£¨í”„ë¥¼ ëŒë ¤ì„œ ê°’ì„ ì¶œë ¥í•´ì„œ ì¶”ê°€ì ì¸ ì¿¼ë¦¬ê°€ ì•ˆë‚˜ê°„ë‹¤.)</li>
        <li>ì—”í‹°í‹° ê·¸ë˜í”„ ê¸°ëŠ¥ ì‚¬ìš© (ì¶”í›„ì— ë°°ìš¸ ë‚´ìš©)</li>
        <li>ë°°ì¹˜ì‚¬ì´ì¦ˆ í™œìš© (ì¶”í›„ì— ë°°ìš¸ ë‚´ìš©)</li>
      </ul>
    </li>
  </ul>
</blockquote>

<h3 id="3-ì˜ì†ì„±-ì „ì´cascadeì™€-ê³ ì•„-ê°ì²´">3. ì˜ì†ì„± ì „ì´(CASCADE)ì™€ ê³ ì•„ ê°ì²´</h3>

<blockquote>
  <ul>
    <li><strong>ì˜ì†ì„± ì „ì´ : CASCADE</strong>
      <ul>
        <li>íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ê³  ì‹¶ì„ ë•Œ</li>
        <li>ì˜ˆ : ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•Œ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì €ì¥</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>ì£¼ì˜</strong>
      <ul>
        <li>ì˜ì†ì„± ì „ì´ëŠ” ì—°ê´€ê´€ê³„ ë§¤í•‘í•˜ëŠ” ê²ƒê³¼ ì•„ë¬´ ê´€ë ¨ì´ ì—†ë‹¤.</li>
        <li>ì—”í‹°í‹°ë¥¼ ì˜ì†í™”í•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì†í™”í•˜ëŠ” í¸ë¦¬í•¨ì„ ì œê³µí•  ë¿ì´ë‹¤.</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>CASCADEì˜ ì¢…ë¥˜</strong>
      <ul>
        <li>ALL : ëª¨ë‘ ì ìš© (ë¼ì´í”„ì‚¬ì´í´ ì „ë¶€ ë§ì¶œ ë•Œ)</li>
        <li>PERSIST : ì˜ì† (ì €ì¥í• ë•Œë§Œ ë¼ì´í”„ì‚¬ì´í´ ë§ì¶œ ë•Œ)</li>
        <li>REMOVE : ì‚­ì œ</li>
        <li>MERGE : ë³‘í•©</li>
        <li>REFRESH : REFRESH</li>
        <li>DETACH : DETACH</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>ì“°ë©´ ì•ˆë˜ëŠ” ê²½ìš°</strong>
      <ul>
        <li>ì†Œìœ ìê°€ ë‘˜ ì´ìƒì¼ ë•Œ</li>
        <li>ì™„ì „íˆ ì¢…ì†ì ì´ì§€ ì•Šì„ ë•Œ</li>
        <li>ë¼ì´í”„ì‚¬ì´í´ì´ ë‹¤ë¥¼ ë•Œ</li>
      </ul>
    </li>
  </ul>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"parent"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;</span> <span class="n">childList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addChild</span><span class="o">(</span><span class="nc">Child</span> <span class="n">child</span><span class="o">){</span>
        <span class="n">childList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">child</span><span class="o">);</span>
        <span class="n">child</span><span class="o">.</span><span class="na">setParent</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"parent_id"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Parent</span> <span class="n">parent</span><span class="o">;</span>
<span class="o">}</span>

<span class="nc">JpaMainì˜</span> <span class="k">try</span> <span class="n">ë‚´ë¶€</span>
<span class="k">try</span><span class="o">{</span>
    <span class="nc">Child</span> <span class="n">child1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Child</span><span class="o">();</span>
    <span class="nc">Child</span> <span class="n">child2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Child</span><span class="o">();</span>

    <span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Parent</span><span class="o">();</span>
    <span class="n">parent</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">child1</span><span class="o">);</span>
    <span class="n">parent</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">child2</span><span class="o">);</span>

    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span> <span class="c1">//Parentì˜ CascadeType.All ë•Œë¬¸ì— childë„ ê°™ì´ persistëœë‹¤.</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <ul>
    <li><strong>ê³ ì•„ê°ì²´</strong>
      <ul>
        <li>ê³ ì•„ ê°ì²´ ì œê±° : ë¶€ëª¨ ì—”í‹°í‹°ì™€ ì—°ê´€ê´€ê³„ê°€ ëŠì–´ì§„ ìì‹ ì—”í‹°í‹°ë¥¼ ìë™ìœ¼ë¡œ ì‚­ì œ</li>
        <li><strong>orphanRemoval = true (ì¡°ì‹¬íˆ ì‚¬ìš©í• ê²ƒ)</strong></li>
        <li>Parent parent1 = em.find(Parent.class, id); <br /> parent1.getChildren().remove(0); <br /> ìì‹ ì—”í‹°í‹°ë¥¼ ì»¬ë ‰ì…˜ì—ì„œ ì œê±°</li>
        <li>DELETE FROM CHILD WHERE ID=? ì¿¼ë¦¬ê°€ ë‚˜ê°„ë‹¤</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>ì£¼ì˜</strong>
      <ul>
        <li>ì°¸ì¡°ê°€ ì œê±°ëœ ì—”í‹°í‹°ëŠ” ë‹¤ë¥¸ ê³³ì—ì„œ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” ê³ ì•„ ê°ì²´ë¡œ ë³´ê³  ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥</li>
        <li><strong>ì°¸ì¡°í•˜ëŠ” ê³³ì´ í•˜ë‚˜</strong>ì¼ ë•Œ ì‚¬ìš©í•´ì•¼í•¨</li>
        <li><strong>íŠ¹ì • ì—”í‹°í‹°ê°€ ê°œì¸ ì†Œìœ </strong>í•  ë•Œ ì‚¬ìš©</li>
        <li>@OneToOne, @OneToManyë§Œ ê°€ëŠ¥</li>
        <li>ì°¸ê³  : ê°œë…ì ìœ¼ë¡œ ë¶€ëª¨ë¥¼ ì œê±°í•˜ë©´ ìì‹ì€ ê³ ì•„ê°€ ëœë‹¤. ë”°ë¼ì„œ ê³ ì•„ ê°ì²´ ì œê±° ê¸°ëŠ¥ì„ í™œì„±í™” í•˜ë©´, ë¶€ëª¨ë¥¼ ì œê±°í•  ë•Œ ìì‹ë„ í•¨ê»˜ ì œê±°ëœë‹¤. ì´ê²ƒì€ CascadeType.REMOVEì²˜ëŸ¼ ë™ì‘í•œë‹¤.</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li><strong>ì˜ì†ì„± ì „ì´ + ê³ ì•„ê°ì²´, ìƒëª…ì£¼ê¸°</strong>
      <ul>
        <li>CascadeType.All + orphanRemoval=true</li>
        <li>ìŠ¤ìŠ¤ë¡œ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•˜ëŠ” ì—”í‹°í‹°ëŠ” em.persist()ë¡œ ì˜ì†í™”, em.remove()ë¡œ ì œê±°</li>
        <li>ë‘ ì˜µì…˜ì„ ëª¨ë‘ í™œì„±í™” í•˜ë©´ ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ í†µí•´ì„œ ìì‹ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ</li>
        <li>ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„(DDD)ì˜ Aggregate Root ê°œë…ì„ êµ¬í˜„í•  ë•Œ ìœ ìš©</li>
      </ul>
    </li>
  </ul>
</blockquote>

<h2 id="etc-ì—ëŸ¬">etc. ì—ëŸ¬</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cannot drop "ITEM" because "FKF1UERPNMN49VL1SPBBPLGXAUN, FKABGE9EQALSPCEJIJ53RAT7PJH" depends on it; SQL statement:
drop table item [90107-200]
í…Œì´ë¸”ì„ ë“œëí•  ë•Œ ì´ëŸ° ì˜¤ë¥˜ê°€ ë°œìƒ í•  ê²½ìš°
pom.xmlì—ì„œ hibernate ë²„ì „ì„ 5.4.13.Finalë¡œ ë°”ê¾¸ê¸°
H2 ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „ì„ 1.4.200ë¡œ ë°”ê¾¸ê¸°(ì¬ì„¤ì¹˜)
</code></pre></div></div>

<h2 id="quiz">Quiz</h2>

<p><strong>ë¬¸ì œ 1.</strong> ì¡°ì¸ ì „ëµ, ë‹¨ì¼ í…Œì´ë¸” ì „ëµë³´ë‹¤ êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ë” í¸í•˜ê³  ì¢‹ë‹¤?</p>

<details>
<summary>ì •ë‹µ í™•ì¸</summary>
<div>
    <p><br /></p>
    <h1>X</h1>
    <p><br /> êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµì€ DB ì„¤ê³„ìì™€ ORM ì „ë¬¸ê°€ ë‘˜ ë‹¤ ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ë°©ë²•ì´ë‹¤.
ì—¬ëŸ¬ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ê²½ìš° UNIONì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ì´ ëŠë¦¬ë‹¤.
<br /></p>
  </div>
</details>
<p><br /></p>

<p><strong>ë¬¸ì œ 2.</strong> @MappedSuperclass ì‚¬ìš©í•œ BaseEntityëŠ” DBí…Œì´ë¸”ë¡œ ë§Œë“¤ì–´ì§„ë‹¤?</p>

<details>
<summary>ì •ë‹µ í™•ì¸</summary>
<div>
    <p><br /></p>
    <h1>X</h1>
    <p><br />
ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” ìì‹ í´ë˜ìŠ¤ì— ë§¤í•‘ ì •ë³´ë§Œ ì œê³µí•´ì£¼ëŠ” ì—­í• ë§Œ í•˜ê¸° ë•Œë¬¸ì— í…Œì´ë¸”ì´ ë§Œë“¤ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤.
<br /></p>
  </div>
</details>
<p><br /></p>

<p><strong>ë¬¸ì œ 3.</strong> ì•„ë˜ ì½”ë“œì˜ ì¶œë ¥ê²°ê³¼ëŠ”? <br /> 1. em.find(Member.class, m.getId()) <br /> em.flush(); em.clear(); <br /> 2. em.getReference(Member.class, m.getId()) <br /> System.out.println(â€œ1==2 : â€œ + 1==2);</p>

<details>
<summary>ì •ë‹µ í™•ì¸</summary>
<div>
    <p><br /></p>
    <h1>false</h1>
    <p><br />
em.find() ì´í›„ member ê°ì²´ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¡œ ê´€ë¦¬ëœë‹¤. ê·¸ë¦¬ê³  í•œ íŠ¸ë™ì­ì…˜ì•ˆì—ì„œ ì´ ê°ì²´ì˜ ë™ì¼í•¨ì„ ë³´ì¥í•œë‹¤. <br /> ê·¸ëŸ¬ë‚˜ clearëŠ” ì˜ì†ì„±ìœ¼ë¡œ ê´€ë¦¬í•˜ë˜ ëª¨ë“  ê°ì²´ë¥¼ ë‹¤ ì‚­ì œí•˜ê²Œ ëœë‹¤. <br /> ê·¸ë¦¬ê³  ë‚œ ë’¤ ë‹¤ì‹œ DBì˜ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ member ë¥¼ ìƒì„±í•˜ê²Œ ë˜ë©´ ì´ì „ì— ê´€ë¦¬í•˜ë˜ memberì™€ëŠ” ê´€ê³„ ì—†ëŠ” ê°ì²´ê°€ ëœë‹¤.
<br /></p>
  </div>
</details>
<p><br /></p>
:ET